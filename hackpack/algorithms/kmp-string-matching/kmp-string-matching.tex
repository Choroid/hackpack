\section{Knuth-Morris-Pratt String Matching}\index{string matching}
This algorithm is a method of speeding up string searches by using mismatches to determine where a search should continue.
Prior to beginning a search, a table of values is computed.
In this table (called the partial match table) are the lengths of the longest proper prefixes that match the longest proper suffixes up to the given permutation of characters.

For example, let us consider the string 'abababcd'.
Throughout the construction of the table, we consider the first N characters of the string to yield the substring we want to analyze.

\begin{description}
\item[$N = 1$ 'a']
This substring contains only one character and cannot contain a proper prefix, therefore, we set the first index to 0.

\item[$N = 2$ 'ab']
There is only one proper prefix ('a') and one proper suffix ('b'), and they do not match, therefore, this one is set to 0 as well.

\item[$N = 3$ 'aba']
Now, we have two prefixes, 'a' and 'ab', and two suffixes, 'a' and 'ba'.
While, 'ab' and 'ba' do not match, 'a' and 'a' do.
So, this time, we can set the value to 1, because that is the length of the longest match.

\item[$N = 4$ 'abab']
Suffixes: 'a', 'ab', and 'aba'.
Prefixes: 'b', 'ab', and 'bab'.
Perusing the substrings in decreasing length, 'ab' provides a match. The value is set to 2.

\item[$N = 5$ 'ababa']
Suffixes: 'a', 'ab', 'aba', and 'abab'.
Prefixes: 'a', 'ba', 'aba', and 'baba'.
The longest match here is 'aba', with a length of 3.

\item[$N = 6$ 'ababab']
Suffixes: 'a', 'ab', 'aba', 'abab', and, 'ababa'.
Prefixes: 'b', 'ab', 'bab', 'abab', and, 'babab'.
This time, the longest match is 'abab', so we set a value of 4.

\item[$N = 7$ 'abababc']
Suffixes: 'a', 'ab', 'aba', 'abab', 'ababa', and 'ababab'.
Prefixes: 'c', 'bc', 'abc', 'babc', 'ababc', and 'bababc'.
In this case, there are no matches, so the value is zero.

\item[$N = 8$ 'abababcd']
Suffixes: 'a', 'ab', 'aba', 'abab', 'ababa', 'ababab', and 'abababc'
Prefixes: 'd', 'cd', 'bcd', 'abcd', 'babcd', 'ababcd', and 'bababcd'
There are no matching substrings; the value here is zero.
\end{description}

When a mismatch occurs, and by consulting this table of values, the KMP algorithm can tell us where to resume the search for the desired keyword again.
The KMP algorithm (as it is commonly known as) runs in $O(k + n)$ time.

\subsection{Applications}
\begin{itemize}
	\item More efficient string searches.
\end{itemize}

\subsection{Contest Problem, The Fine Print}
Due to his excessive milking of the cows without appropriate compensation, Farmer John has, unsurprisingly, received an ultimatum from the cows.
If the two parties cannot come to an agreement, Farmer John risks internal insurgency.
Though he is willing to reduce his demands and compensate them with more grazing time, the document he has received is unbearably lengthy.

Farmer John can recall that, lately, the cows have been nagging him to build a swimming pool.
Therefore, it is likely that a condition has been added to force him to concede to building this pool.

To save Farmer John from a long night (he works early mornings) find out if anything about a 'pool' has been added anywhere.

\subsubsection{Input}
\begin{itemize}
	\item Text from standard input representing the legal document terminated with an EOF.
\end{itemize}
\lstinputlisting[label=The Fine Print Sample Input, caption=The Fine Print Sample Input, linerange={1-2,1026-1032,1374-1377}]{./algorithms/kmp-string-matching/problems/fine-print/fine-print.in}

\subsubsection{Output}
\begin{itemize}
	\item The sentence containing 'pool' if it exists. All sentences within the text end in a period.
	\item The string ''The agreement does not mention a pool.'' if a sentence containing 'pool' doesn't exist.
\end{itemize}
\lstinputlisting[label=The Fine Print Sample Output, caption=The Fine Print Sample Output]{./algorithms/kmp-string-matching/problems/fine-print/fine-print.out}

\subsubsection{Sample Solution}
\lstinputlisting[label=The Fine Print Sample Solution, caption=The Fine Print Sample Solution]{./algorithms/kmp-string-matching/problems/fine-print/fine-print.cpp}

\subsection{Contest Problem, DNA Splicing}
The No-bonez alien race has descended upon Farmer John's beloved cows!
Rather than abducting them though, they have begun experimenting on them genetically.
By splicing Farmer John's cow's DNA with their own cows, the aliens hope to accomplish some unknown objective.
With the help of the local geneticist, Farmer John can save all of his cows.
To do so, he must identify the alien DNA and remove it.

DNA sequences are composed of different combinations of 'A', 'T', 'C', and 'G'.
The alien DNA can be easily be identified because it always begins and ends with the inert sequence marker \mbox{'TATATTGCCGTTACG'}.
Between the headers and footers lies the foreign DNA that must be removed.

Remove the alien DNA and save all of Farmer John's cows.

\subsubsection{Input}
\begin{itemize}
\item Text from standard input representing the cow's DNA sequence spliced with the alien cow's DNA terminated with an EOF.
\end{itemize}
\lstinputlisting[label=DNA Splicing Sample Input, caption=DNA Splicing Sample Input]{./algorithms/kmp-string-matching/problems/dna-splice/dna-splice.in}

\subsubsection{Output}
\begin{itemize}
\item The cow's DNA sequence with the alien DNA removed.
\end{itemize}
\lstinputlisting[label=DNA Splicing Sample Output, caption=DNA Splicing Sample Output]{./algorithms/kmp-string-matching/problems/dna-splice/dna-splice.out}

\subsubsection{Lessons Learned}
\begin{itemize}
	\item The KMP algorithm improves upon regular iterative string matching.
	\item A time penalty, $O(k)$, is incurred to build the partial match table.
	\item It runs exactly like straightforward string matching without the advantage of the partial match table.
\end{itemize}

